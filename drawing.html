<!doctype html>
<html>
<head>
	<meta charset="UTF-8" />
	<title>编辑项目</title>
	<link rel="stylesheet" href="src/css/style.css" />
</head>
<body>
	<div class="header">
		<div class="header_logo">
			<a href="">designh5</a>
		</div>
		<div class="draw_bar">
			<div class="draw_bar_item"><i class="icon-file-text"></i>文本</div>
			<div class="draw_bar_item"><i class="icon-share2"></i>形状</div>
			<div class="draw_bar_item"><i class="icon-airplane"></i>按钮</div>
			<div class="draw_bar_item"><i class="icon-music"></i>音乐</div>
			<div class="draw_bar_item"><i class="icon-image"></i>图片</div>
			<div class="draw_bar_item"><i class="icon-yelp"></i>表单</div>
			<div class="draw_bar_item"><i class="icon-stackoverflow"></i>互动</div>
			<div class="draw_bar_item"><i class="icon-star-full"></i>特效</div>
			<div class="draw_bar_item"><i class="icon-cloud-check"></i>应用</div>
		</div>
		<div class="draw_menu">
			<div class="draw_menu_item"><i class="icon-pencil"></i>编辑</div>
			<div class="draw_menu_item"><i class="icon-info"></i>信息</div>
			<div class="draw_menu_item"><i class="icon-eye-minus"></i>预览</div>
		</div>
	</div>

	<div class="draw">
		<div class="draw_sider">
			<div class="draw_sider_item active"><i class="icon-pinterest"></i>页面</div>
			<div class="draw_sider_item"><i class="icon-image"></i>素材</div>
			<div class="draw_sider_item"><i class="icon-books"></i>模版</div>
			<div class="draw_sider_item"><i class="icon-power"></i>特效</div>
			<div class="draw_sider_item"><i class="icon-folder"></i>库</div>
		</div>
		
		<!-- 左侧设置项 -->
		<div class="draw_tool">
			<!-- 页面 -->
			<div class="draw_page">
				<div class="draw_page_add"><i class="icon-plus"></i></div>
				<div class="draw_page_layer">1</div>
				<div class="draw_page_layer">2</div>
				<div class="draw_page_layer">3</div>
				<div class="draw_page_layer active">4</div>
			</div>
			
			<!-- 素材 -->
			<div class="draw_tool_material">
				音乐
				图片
			</div>
			
			<!-- 模版 -->
			<div class="draw_tool_material">
				
			</div>
			
			<!-- 特效 -->
			<div class="draw_tool_material">
				
			</div>
			
			<!-- 库 -->
			<div class="draw_tool_material">
				
			</div>
				
		</div>
		
		<div class="draw_view">
			<div class="draw_view_window">
				<div class="draw_panel">
					
					<div class="dragable ui">
						<div class="ui_resizable">
							<div class="elm">
								<img draggable="false" src="http://preview.quanjing.com/ul1092/ul1092-1944.jpg" alt="" />
							</div>
							
							<div class="ui_resizable_rotate"><i class="icon-spinner11"></i></div>
							<div class="ui_resizable_handle resiz_a"></div>
							<div class="ui_resizable_handle resiz_b"></div>
							<div class="ui_resizable_handle resiz_c"></div>
							<div class="ui_resizable_handle resiz_d"></div>
							<div class="ui_resizable_handle resiz_e"></div>
							<div class="ui_resizable_handle resiz_f"></div>
							<div class="ui_resizable_handle resiz_g"></div>
							<div class="ui_resizable_handle resiz_h"></div>
						</div>
						
						
					</div>
					
				</div>
			</div>
		</div>
		
		
		<div class="draw_set">
			
		</div>
	</div>
	<script>
		var dragable =  document.querySelector('.dragable');
		dragable.addEventListener('dragstart', function(){
			this.style.left='100';
			this.style.top='100';
		});
		function offset(x,y){
			this.x = x;
			this.y = y;
		}
		
		function getOffset(e){
			var pos = new offset(e.offsetLeft,e.offsetTop);
			return pos;
		}
		

var params = {
	left: 0,
	top: 0,
	currentX: 0,
	currentY: 0,
	flag: false
};
//获取相关CSS属性
var getCss = function(o,key){
	return o.currentStyle? o.currentStyle[key] : document.defaultView.getComputedStyle(o,false)[key]; 	
};

//拖拽的实现
var startDrag = function(bar, target, callback){
	if(getCss(target, "left") !== "auto"){
		params.left = getCss(target, "left");
	}
	if(getCss(target, "top") !== "auto"){
		params.top = getCss(target, "top");
	}
	//o是移动对象
	bar.onmousedown = function(event){
		params.flag = true;
		if(!event){
			event = window.event;
			//防止IE文字选中
			bar.onselectstart = function(){
				return false;
			}  
		}
		var e = event;
		params.currentX = e.clientX;
		params.currentY = e.clientY;
	};
	document.onmouseup = function(){
		params.flag = false;	
		if(getCss(target, "left") !== "auto"){
			params.left = getCss(target, "left");
		}
		if(getCss(target, "top") !== "auto"){
			params.top = getCss(target, "top");
		}
	};
	document.onmousemove = function(event){
		var e = event ? event: window.event;
		if(params.flag){
			var nowX = e.clientX, nowY = e.clientY;
			var disX = nowX - params.currentX, disY = nowY - params.currentY;
			target.style.left = parseInt(params.left) + disX + "px";
			target.style.top = parseInt(params.top) + disY + "px";
		}
		
		if (typeof callback == "function") {
			callback(parseInt(params.left) + disX, parseInt(params.top) + disY);
		}
	}	
};

startDrag(document.querySelector('.ui_resizable'),document.querySelector('.dragable') );
	</script>
</body>
</html>